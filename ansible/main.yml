---
- name: Configure base operating system
  hosts: all
  become: true
  vars_files:
    - "inventory/host_variables/{{ ansible_host }}.yml"
  roles:
    - base
- name: Configure DNS Server (BIND9)
  hosts: dns
  become: true
  vars_files:
    - "inventory/{{ ansible_host }}.yml"
  roles:
    - bind9
- name: Configure public software mirror
  hosts: mirror
  become: true
  gather_facts: true
  vars_files:
    - "inventory/host_variables/{{ ansible_host }}.yml"
  roles:
    - mirror
- name: Configure Plex Media Server
  hosts: plex
  become: true
  vars_files:
    - "inventory/host_variables/{{ ansible_host }}.yml"
  roles:
    - plex
- name: Configure netboot servers
  hosts: netboot
  become: true
  vars_files:
    - "inventory/host_variables/{{ ansible_host }}.yml"
  roles:
    - pxeboot
- name: Configure HAProxy reverse proxy servers
  hosts: haproxy
  become: true
  vars_files:
    - "inventory/host_variables/{{ ansible_host }}.yml"
  roles:
    - haproxy
- name: Configure Traefik reverse proxy servers
  hosts: traefik
  become: true
  vars_files:
    - "inventory/host_variables/{{ ansible_host }}.yml"
  roles:
    - traefik
- name: Configure ACME.sh certificate management server
  hosts: acme
  become: true
  vars_files:
    - "inventory/host_variables/{{ ansible_host }}.yml"
  roles:
    - acme